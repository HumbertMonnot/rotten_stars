<div class="container">

  <div class="text-description">
    <div id="retour">
      <%= link_to :root do %>
        <i class="fa-solid fa-circle-chevron-left"></i>Retour
      <% end %>
      <h1 class="pl-32 pt-32"><%= @prestation.name %></h1>
    </div>
    <h2><%= @prestation.category %></h2>
    <h3><%= @prestation.address %></h3>

  </div>

<div class="img-prestation">
<%= cl_image_tag @prestation.poster.key,height: 400, width: 600 %>
<div class="p-prestation">
  <p><%= @prestation.description %></p>
</div>
</div>

<div class="ctr-card">
  <div class="card-reservation">
    <h2>Prix</h2>
    <h3><%= "#{@prestation.price}€/prestation" %></h3>
    <%= simple_form_for [@prestation, @reservation] do |f| %>
        <%= f.input :start_date, as: :date, html5: true %>
        <%= f.input :end_date, as: :date, html5: true %>
        <%= f.button :submit, "Réserver", class: 'btn fr w-45 mb-32px' %>
    <% end %>
    <h3><% if @reservation.start_date == nil || @reservation.end_date == nil %>
      <p>Total: 0€</p>
      <% else %>
        <% duration = (@reservation.end_date - @reservation.start_date).to_i / (3600 * 24) + 1 %>
        <% reservation_total = @prestation.price * duration %>
        <%= "Total: #{reservation_total}€" %>
      <% end %>



  </div>


  <div class="card-comment">
    <h2 class="card-comment-title">Comment :</h2>
      <% @prestation.reservations.each do |reservation|%>
        <h3 class="card-comment-name"><%= reservation.user.first_name %>, <%= reservation.user.last_name %></h3>
        <% reservation.reviews.each do |review| %>
          <p><%= review.comment %></p>
        <% end %>
      <% end %>
  </div>
</div>
</div>
